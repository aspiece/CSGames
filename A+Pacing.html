<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pacing Guide</title>
  <style>
    /* Removed forced landscape @page rules per request */
    :root{--bg:#0f172a;--card:#111827;--text:#e5e7eb;--muted:#9ca3af;--accent:#22d3ee;--table:#1f2937}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif}
    .wrap{max-width:1400px;margin:40px auto;padding:0 20px}
    h1{font-size:clamp(1.6rem,3vw,2.5rem);margin:0 0 10px}
    h2{font-size:1.25rem;margin:0 0 10px}
    p{color:var(--muted);margin:0 0 24px;font-size:1rem}
    .card{background:var(--card);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.25);overflow:hidden;padding:18px;font-size:1rem}
    table{width:100%;border-collapse:collapse;font-size:1rem}
    thead{background:var(--table)}
    th,td{padding:14px 12px;vertical-align:top;font-size:1rem}
    th{font-weight:700;text-align:left;letter-spacing:.02em}
    tbody tr{border-bottom:1px solid rgba(255,255,255,.06)}
    tbody tr:hover{background:rgba(34,211,238,.03)}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    .small{font-size:1rem;color:var(--muted)}
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:rgba(34,211,238,.15);color:#a5f3fc;font-weight:600;font-size:12px;margin-left:6px}
    .sticky{position:sticky;left:0;background:var(--card)}
    @media (max-width:900px){
      table{display:block;overflow:auto;white-space:nowrap}
    }
    ul.agenda{margin:6px 0;padding-left:18px;font-size:13px;line-height:1.4}

    /* Collapsible UI */
    .day-nav{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px;align-items:center}
    .day-btn{background:transparent;border:1px solid rgba(255,255,255,.06);color:var(--text);padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700;font-size:1rem}
    .day-btn.active{background:var(--accent);color:#042023;border:none}
    .day-row{display:none}
    .day-row.visible{display:table-row}
    td.day-toggle{cursor:pointer;width:48px;text-align:center;font-weight:700;border-right:1px solid rgba(255,255,255,.03)}
    .hint{color:var(--muted);font-size:13px;margin-bottom:8px}
    .status{color:var(--muted);margin-bottom:12px}
    .permalink {margin-left:12px;padding:6px 10px;border-radius:8px;background:rgba(255,255,255,.04);color:var(--muted);cursor:pointer;font-size:13px}
    .permalink.copied {background:var(--accent);color:#042023}

    /* Print / PDF layout */
    @media print {
      /* page background and text for PDF */
      html,body { background: #fff; color:#000; }
      /* hide interactive controls */
      .day-nav, #date-picker, #today-btn, #clear-btn, #copy-permalink, .hint, #status { display: none !important; }
      .permalink { display: none !important; }
      /* show all days in table */
      .day-row { display: table-row !important; }
      .day-row.visible { display: table-row !important; }
      /* make table printable and compact */
      table { width:100%; border-collapse:collapse; font-size:12px; color:#000; page-break-inside: auto; }
      thead { background: none !important; color:#000; }
      th, td { color:#000; border:1px solid #bbb; padding:8px; vertical-align:top; }
      .sticky { position:static !important; background:transparent !important; }
      /* avoid page break inside agenda items */
      td { page-break-inside: avoid; }
      /* optional: expand agenda lists readability */
      ul.agenda { padding-left:16px; }

      /* Adjust card layout for print */
      .card-inner {
        max-width: 100%; /* Use full width of the page */
        padding: 20px; /* Add more padding for readability */
        margin: 0 auto; /* Center the content */
      }

      .section {
        margin-bottom: 16px; /* Add more spacing between sections */
      }

      .section h3 {
        font-size: 14px; /* Slightly larger font for headers */
        margin-bottom: 8px;
      }

      .section .section-content {
        font-size: 13px; /* Slightly larger font for content */
        line-height: 1.5; /* Improve readability */
      }
    }

    /* Layout: left rail for day links, right column for vertical lesson sections */
    .layout { display:grid; grid-template-columns:220px 1fr; gap:18px; align-items:start; }
    /* Left rail: always a single vertical column that grows to show all days.
       Use a fixed viewport-based height and vertical scrolling so the list
       continues down the left side for the entire CSV. */
    #day-nav {
      display: flex;
      flex-direction: column;
      flex-wrap: nowrap;                       /* never wrap into new columns */
      gap: 8px;
      /* Use viewport height minus header/controls area so the rail fills page */
      height: calc(100vh - 200px);
      max-height: calc(100vh - 120px);
      overflow-y: auto;                        /* vertical scroll for long lists */
      overflow-x: hidden;
      padding-right: 8px;
      box-sizing: border-box;
      align-items: stretch;
      position: sticky;                        /* keep rail visible while scrolling content */
      top: 20px;
    }
    #day-nav .day-btn { width:100%; text-align:left; white-space:normal; }
    #content-area { min-height:200px; }
    .day-card { display:none; background:transparent; padding:0; margin:0 0 12px; }
    .day-card.visible { display:block; }
    .day-card .card-inner { background:var(--card); padding:14px; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,.18); }
    .section { margin-bottom:10px; }
    .section h3 { margin:0 0 6px; font-size:1.1rem; font-weight:700; color:var(--text); }
    .section p, .section a { margin:0; color:var(--muted); font-size:1rem; line-height:1.6; }
    .section a { color:var(--accent); }
    .section .section-content { margin:0; color:var(--muted); font-size:1rem; line-height:1.6; }
    .section .section-content p { margin:6px 0; }
    /* hide table if present (keeps backward compatibility) */
    #pacing-table { display:none !important; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>CompTIA A+ Pacing Guide</h1>

    <!-- Learning objectives: placed immediately after the main title -->
    <h2 id="learning-objectives" style="margin-top:10px;font-size:1.05rem;color:var(--text);">Learning Objectives</h2>
    <div id="learning-objectives-content" class="card" style="margin:12px 0;padding:12px;">
      <p class="small" style="margin:0;">Add course-level learning objectives here or in the CSV (header: "Learning Objectives") — each day's card will display any matching field under this heading.</p>
    </div>

    <p>Each session follows Merrill’s Effective Instruction (Activation → Demonstration → Application → Integration). All worksheets, videos, and assessments are distributed via Google Classroom. Slides are used to pace class time and display prompts, timers, and brain‑break instructions.</p>

    <div class="card">
      <div class="hint">This page loads its content from pacing.csv in the same directory. Click a date to reveal that day's plan. Each day gets a unique URL (hash).</div>
      <div id="status" class="status">Loading pacing.csv …</div>

      <!-- calendar-style selection: date picker + available-dates grid -->
      <div style="display:flex;flex-wrap:wrap;align-items:center;gap:8px;margin-bottom:12px">
        <label class="small" for="date-picker" style="margin:0">Jump to date:</label>
        <input id="date-picker" type="date" style="padding:6px;border-radius:8px;border:1px solid rgba(255,255,255,.06);background:transparent;color:var(--text)" />
        <button id="today-btn" class="day-btn" type="button" title="Go to today">Today</button>
        <button id="clear-btn" class="day-btn" type="button" title="Collapse all" style="background:transparent">Clear</button>
        <div style="flex:1"></div>
        <button id="download-pdf" class="permalink" title="Download page as PDF">Download PDF</button>
        <button id="copy-permalink" class="permalink" title="Copy permalink for the currently open day" style="display:none">Copy link</button>
      </div>

      <div class="layout">
        <nav id="day-nav" class="day-nav" aria-hidden="false" style="gap:6px;"></nav>
        <main id="content-area" aria-live="polite">
          <!-- Selected day content rendered here as vertical sections -->
        </main>
      </div>
    </div>

    <!-- A+ certification alignment: final heading displayed after the pacing card -->
    <!-- <h2 id="a-plus-alignment" style="margin-top:18px;font-size:1.05rem;color:var(--text);">A+ certification Alignment</h2>
    <div id="a-plus-alignment-content" class="card" style="margin:12px 0;padding:12px;">
      <p class="small" style="margin:0;">Use this section to summarize which CompTIA A+ objectives each lesson maps to (CSV header suggestion: "A+ Alignment"). If present in the CSV, the page will render that content under this heading.</p>
    </div> -->

    <p class="small" style="margin-top:24px;">Guide by <b>aspiece</b>. For feedback or updates, contact the author.</p>
  </div>

  <script>
    // store the CSV header order so renderRows can display columns dynamically
    // ensure CSV_HEADERS only contains non-empty header labels
    let CSV_HEADERS = [];

    // extract first http/https url from a string (returns empty string if none)
    function extractFirstUrl(s) {
      if (!s) return '';
      // match http/https links, allow typical URL characters, stop at whitespace or pipe or quote
      const m = String(s).match(/https?:\/\/[^\s\|"')<>]+/i);
      if (!m) return '';
      // trim common trailing punctuation
      return m[0].replace(/[.,)\]]+$/, '');
    }

    // CSV parser (handles quoted fields and newlines)
    function parseCSV(text) {
      const rows = [];
      let cur = '';
      let row = [];
      let inQuotes = false;
      for (let i = 0; i < text.length; i++) {
        const ch = text[i];
        const next = text[i+1];
        if (ch === '"') {
          if (inQuotes && next === '"') { cur += '"'; i++; } // escaped quote
          else inQuotes = !inQuotes;
          continue;
        }
        if (ch === ',' && !inQuotes) {
          row.push(cur); cur = ''; continue;
        }
        if ((ch === '\n' || ch === '\r') && !inQuotes) {
          if (ch === '\r' && next === '\n') { /* skip paired */ }
          if (cur !== '' || row.length) { row.push(cur); cur = ''; rows.push(row); row = []; }
          continue;
        }
        cur += ch;
      }
      if (cur !== '' || row.length) { row.push(cur); rows.push(row); }
      return rows;
    }

    function csvToObjects(text) {
      const rows = parseCSV(text).filter(r => r.length > 0);
      if (rows.length < 1) return [];

      // If the file contains an initial comment/filepath line (e.g. "// filepath: ..."),
      // skip it so the real CSV header is used.
      let headerRowIndex = 0;
      const firstCell = String(rows[0][0] || '').trim();
      if (firstCell.startsWith('//') || /filepath:/i.test(firstCell)) {
        if (rows.length < 2) return []; // nothing after the comment
        headerRowIndex = 1;
      }

      // preserve original header labels, but filter-out any completely-empty headers
      const rawHeadersAll = rows[headerRowIndex].map(h => (h||'').trim());
      const rawHeaders = rawHeadersAll.map((h,i)=> h || `Column ${i+1}`);
      CSV_HEADERS = rawHeaders.slice(); // keep header order and labels

      // normalized keys for convenient lookup
      const normalizedHeaders = rawHeaders.map(h => h.toLowerCase().replace(/[^a-z0-9]+/g, ''));

      // detect video/slides columns if present (by normalized name)
      const videoNames = ['video','videos','videolink','videolinks'];
      const slideNames = ['slide','slides','slidedeck','slidelink','slidedecklink','deck','presentation'];
      let videoIndex = normalizedHeaders.findIndex(h => videoNames.includes(h));
      let slideIndex = normalizedHeaders.findIndex(h => slideNames.includes(h));

      // if no explicit video/slides headers and there are extra columns, guess at the end columns
      const expectedBaseCount = 8;
      if (videoIndex === -1 && slideIndex === -1) {
        if (rawHeaders.length === expectedBaseCount + 1) videoIndex = expectedBaseCount;
        else if (rawHeaders.length === expectedBaseCount + 2) { videoIndex = expectedBaseCount; slideIndex = expectedBaseCount + 1; }
      }

      const dataRows = rows.slice(headerRowIndex + 1);
      return dataRows.map((r, rowIndex) => {
        const obj = {};
        // attach raw header-labeled fields and normalized keys
        rawHeaders.forEach((h, i) => {
          const value = (r[i] || '').trim();
          obj[h] = value;                                   // exact header label
          obj[normalizedHeaders[i]] = value;                // normalized key
        });

        // convenient canonical aliases for older code paths
        obj.Day = obj.Day || obj.day || obj[normalizedHeaders[0]] || obj[rawHeaders[0]] || String(rowIndex+1);
        obj.Lesson = obj.Lesson || obj.lesson || obj[normalizedHeaders[1]] || obj[rawHeaders[1]] || '';
        obj.Topics = obj.Topics || obj.topics || obj[normalizedHeaders[2]] || obj[rawHeaders[2]] || '';

        // extract video / slides urls (first URL found)
        const rawVideo = (typeof videoIndex === 'number' && videoIndex >= 0) ? (r[videoIndex]||'').trim() : (obj.video||obj.Video||'');
        const rawSlides = (typeof slideIndex === 'number' && slideIndex >= 0) ? (r[slideIndex]||'').trim() : (obj.slides||obj.Slides||'');
        obj.Video = extractFirstUrl(rawVideo || obj.video || obj.Video || '');
        obj.Slides = extractFirstUrl(rawSlides || obj.slides || obj.Slides || '');

        return obj;
      });
    }

    // Parse various date formats and normalize to ISO (yyyy-mm-dd).
    function parseDateString(s) {
      if (!s) return null;
      s = s.trim();
      // if the value is a simple integer (day number like "1", "16"), treat as NOT a date
      if (/^\d+$/.test(s)) return null;
      // If already ISO-like yyyy-mm-dd
      if (/^\d{4}-\d{2}-\d{2}$/.test(s)) return s;
      // Try common US format mm/dd/yyyy or m/d/yyyy
      const m = s.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);
      if (m) {
        let mm = m[1].padStart(2,'0'), dd = m[2].padStart(2,'0'), yy = m[3];
        if (yy.length === 2) yy = '20' + yy;
        return `${yy}-${mm}-${dd}`;
      }
      // Try Date.parse fallback (may accept formats like "Aug 29 2025")
      const d = new Date(s);
      if (!isNaN(d.getTime())) {
        const y = d.getFullYear();
        const mm = String(d.getMonth()+1).padStart(2,'0');
        const dd = String(d.getDate()).padStart(2,'0');
        return `${y}-${mm}-${dd}`;
      }
      return null;
    }

    function formatDisplayDate(iso) {
      if (!iso) return '';
      const d = new Date(iso);
      if (isNaN(d.getTime())) return iso;
      const opts = {month:'short', day:'numeric'};
      return d.toLocaleDateString(undefined, opts);
    }

    // Render rows dynamically from CSV. Accepts arbitrary number of days.
    function renderRows(data) {
      const dayNav = document.getElementById('day-nav');
      const content = document.getElementById('content-area');
      dayNav.innerHTML = '';
      content.innerHTML = '';

      // helper to find a value for a header name with several fallbacks
      function getField(item, header) {
        if (!header) return '';
        // direct match (exact header text)
        if (Object.prototype.hasOwnProperty.call(item, header) && item[header]) return item[header];
        // common normalized keys
        const norm = header.toLowerCase().replace(/[^a-z0-9]+/g, '');
        const tryKeys = [
          header,
          header.replace(/\s+/g, ''),
          header.toLowerCase(),
          header.charAt(0).toUpperCase() + header.slice(1),
          norm,
          norm.charAt(0).toUpperCase() + norm.slice(1)
        ];
        for (const k of tryKeys) {
          if (k && Object.prototype.hasOwnProperty.call(item, k) && item[k]) return item[k];
        }
        // fallback known canonical keys
        if ((/day/i).test(header) && (item.Day || item.day)) return item.Day || item.day;
        if ((/lesson/i).test(header) && (item.Lesson || item.lesson)) return item.Lesson || item.lesson;
        if ((/topic/i).test(header) && (item.Topics || item.topics)) return item.Topics || item.topics;
        if ((/agenda/i).test(header) && (item.Agenda || item.agenda)) return item.Agenda || item.agenda;
        if ((/brain/i).test(header) && (item.BrainBreak || item.brainbreak)) return item.BrainBreak || item.brainbreak;
        if ((/summative|assessment/i).test(header) && (item.Summative || item.summative)) return item.Summative || item.summative;
        if ((/during|duringclass/i).test(header) && (item.DuringClass || item.duringclass)) return item.DuringClass || item.duringclass;
        if ((/teacher|prep/i).test(header) && (item.TeacherPrep || item.teacherprep)) return item.TeacherPrep || item.teacherprep;
        if ((/video/i).test(header) && (item.Video || item.video)) return item.Video || item.video;
        if ((/slide|deck|slide deck/i).test(header) && (item.Slides || item.slides)) return item.Slides || item.slides;
        return '';
      }

      data.forEach((item, idx) => {
        const id = getField(item, CSV_HEADERS[0]) || String(idx+1);
        const iso = parseDateString(getField(item, 'Day') || getField(item, CSV_HEADERS[0])) || '';

        // nav button (left column)
        const btn = document.createElement('button');
        btn.className = 'day-btn';
        btn.type = 'button';
        btn.textContent = iso ? formatDisplayDate(iso) : id;
        btn.title = id;
        btn.dataset.day = id;
        btn.dataset.date = iso;
        btn.addEventListener('click', () => openDay(id));
        dayNav.appendChild(btn);

        // content card (right column): build a section for each CSV header in order
        const card = document.createElement('article');
        card.className = 'day-card';
        card.setAttribute('data-day', id);
        card.setAttribute('data-date', iso);
        let inner = '<div class="card-inner">';
        CSV_HEADERS.forEach(header => {
          const raw = getField(item, header) || '';
          const keyNorm = (header || '').toLowerCase();
          const url = extractFirstUrl(raw);
          let contentHtml = '';
          if (url) {
            if (keyNorm.includes('slide') || keyNorm.includes('deck')) {
              contentHtml = `<a href="${escapeAttr(url)}" target="_blank" rel="noopener noreferrer" download>Download</a>`;
            } else {
              contentHtml = `<a href="${escapeAttr(url)}" target="_blank" rel="noopener noreferrer">${escapeHtml(url)}</a>`;
            }
          } else {
            const sentences = splitSentences(raw);
            if (sentences.length === 0) contentHtml = '<span class="small">—</span>';
            else contentHtml = sentences.map(s => `<p>${escapeHtml(s)}</p>`).join('');
          }
          // use a block container (.section-content) instead of nesting <p> tags
          inner += `<div class="section"><h3>${escapeHtml(header)}</h3><div class="section-content">${contentHtml}</div></div>`;
        });
        inner += '</div>';
        card.innerHTML = inner;
        content.appendChild(card);
      });
      // wire up date-picker and other UI based on created cards
      initCollapsibleUI();
    }

    function escapeHtml(s) {
      return String(s)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    // escape for attribute values (minimal)
    function escapeAttr(s) {
      return String(s).replace(/"/g, '%22').replace(/'/g, '%27');
    }

    // split raw text into sentences, preserving punctuation
    function splitSentences(text) {
      if (!text) return [];
      // match sequences ending with . ! ? or end of string
      const parts = text.match(/[^.!?]+[.!?]*/g);
      return parts ? parts.map(p => p.trim()).filter(Boolean) : [text.trim()];
    }

    // Fetch pacing.csv from same directory and render it
    function fetchPacingCsv() {
      const statusEl = document.getElementById('status');
      return fetch('pacing.csv', {cache: 'no-store'})
        .then(resp => {
          if (!resp.ok) throw new Error('pacing.csv not found (HTTP ' + resp.status + ')');
          return resp.text();
        })
        .then(text => {
          const objs = csvToObjects(text);
          if (!objs.length) throw new Error('pacing.csv is empty or malformed');
          renderRows(objs);
          statusEl.textContent = `Loaded pacing.csv (${objs.length} day${objs.length===1?'':'s'})`;
          setTimeout(() => applyInitialRoute(), 20);
        })
        .catch(err => {
          console.error(err);
          document.getElementById('status').textContent = 'Error loading pacing.csv — see console for details.';
          alert('Could not load pacing.csv from the same directory. Ensure pacing.csv exists and uses expected headers.');
        });
    }

    // Open a day by its Day value (exact match), ISO date (yyyy-mm-dd), or numeric index (1-based)
    function openDay(dayValue) {
      const cards = Array.from(document.querySelectorAll('.day-card'));
      if (!cards.length) return;
      let target = null;
      const val = String(dayValue || '');
      // try data-date then data-day then numeric index
      target = cards.find(c => (c.getAttribute('data-date') || '') === val) ||
               cards.find(c => c.getAttribute('data-day') === val);
      if (!target) {
        const idx = parseInt(val, 10);
        if (!Number.isNaN(idx) && idx >= 1 && idx <= cards.length) target = cards[idx-1];
      }
      if (!target) return false;
      cards.forEach(c => c.classList.remove('visible'));
      target.classList.add('visible');
      document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('active'));
      const btn = Array.from(document.querySelectorAll('.day-btn')).find(b => b.dataset.day === (target.getAttribute('data-day') || b.dataset.day));
      if (btn) btn.classList.add('active');
      const hash = `day-${encodeURIComponent(target.getAttribute('data-date')||target.getAttribute('data-day')||'')}`;
      if (location.hash !== `#${hash}`) location.hash = hash;
      document.getElementById('copy-permalink').style.display = 'inline-block';
      target.scrollIntoView({behavior: 'smooth', block: 'center'});
      return true;
    }

    // Build navigation and wire up toggles
    function initCollapsibleUI() {
      const cards = Array.from(document.querySelectorAll('.day-card'));
      const picker = document.getElementById('date-picker');
      const dates = cards.map(c => c.getAttribute('data-date')).filter(Boolean).sort();
      if (dates.length) {
        picker.min = dates[0]; picker.max = dates[dates.length-1];
      } else { picker.removeAttribute('min'); picker.removeAttribute('max'); }

      // wire picker change to open day
      picker.onchange = (e) => { if (e.target.value) openDay(e.target.value); };

      document.getElementById('today-btn').onclick = () => {
        const todayIso = new Date().toISOString().slice(0,10);
        if (!openDay(todayIso)) {
          const next = dates.find(d => d >= todayIso) || dates[0];
          if (next) openDay(next);
        }
      };
      document.getElementById('clear-btn').onclick = () => {
        cards.forEach(c => c.classList.remove('visible'));
        document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('active'));
        history.replaceState(null, '', location.pathname + location.search);
        document.getElementById('copy-permalink').style.display = 'none';
      };
    }

    // Hash helpers
    function parseHash() {
      if (!location.hash) return null;
      const h = location.hash.replace(/^#/, '');
      if (h.startsWith('day-')) return decodeURIComponent(h.slice(4));
      return null;
    }

    function applyInitialRoute() {
      const dayFromHash = parseHash();
      if (dayFromHash) {
        const opened = openDay(dayFromHash);
        if (!opened) {
          const num = dayFromHash.match(/\d+/);
          if (num) openDay(num[0]);
        }
      }
    }

    // Permalink copy
    function setupPermalink() {
      const btn = document.getElementById('copy-permalink');
      btn.addEventListener('click', async () => {
        try {
          await navigator.clipboard.writeText(location.href);
          btn.classList.add('copied'); btn.textContent = 'Copied';
          setTimeout(() => { btn.classList.remove('copied'); btn.textContent = 'Copy link'; }, 1500);
        } catch (e) {
          alert('Could not copy link. Please copy manually: ' + location.href);
        }
      });

      window.addEventListener('hashchange', () => {
        const dayFromHash = parseHash();
        if (dayFromHash) openDay(dayFromHash);
      });
    }

    // Download PDF (uses browser print -> Save as PDF)
    function setupPdfDownload() {
      const btn = document.getElementById('download-pdf');
      if (!btn) return;
      btn.addEventListener('click', () => {
        // Get all day cards and hide non-visible ones
        const allCards = document.querySelectorAll('.day-card');
        const visibleCards = document.querySelectorAll('.day-card.visible');

        allCards.forEach(card => {
          if (!card.classList.contains('visible')) {
            card.style.display = 'none'; // Temporarily hide non-visible cards
          }
        });

        // Trigger print dialog
        setTimeout(() => {
          window.print();

          // Restore all cards after printing
          setTimeout(() => {
            allCards.forEach(card => {
              card.style.display = ''; // Restore original display state
            });
          }, 500);
        }, 150);
      });
    }

    document.addEventListener('DOMContentLoaded', function() {
      setupPermalink();
      setupPdfDownload();
      fetchPacingCsv();
    });
  </script>
</body>
</html>